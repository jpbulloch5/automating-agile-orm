---
- name:
  hosts: all
  tasks:
  - name: Ensure JRE 8 is present
    become: yes
    package:
        name: openjdk-8-jre-headless
        state: present
  - name: Create ~/tomcat directory if needed
    file:
        path: /home/azurruser/tomcat
        state: directory
  - name: remove bad directory
    become: yes
    file:
        path: ~/tomcat
        state: absent
  - name: download Tomcat
    get_url:
        url: http://mirrors.estointernet.in/apache/tomcat/tomcat-8/v8.5.68/bin/apache-tomcat-8.5.68.tar.gz
        dest: /home/azurruser/tomcat
  - name: install Tomcat
    unarchive:
        src: /home/azurruser/tomcat/apache-tomcat-8.5.68.tar.gz
        dest: /home/azurruser/tomcat
        remote_src: yes
  - name: start tomcat service
    shell: nohup /home/azurruser/tomcat/apache-tomcat-8.5.68/bin/startup.sh